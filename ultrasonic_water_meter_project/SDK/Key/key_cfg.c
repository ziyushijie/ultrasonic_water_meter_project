#include "key_cfg.h"

//===全局变量定义
KEY_HandleType		g_key_one = {0};
pKEY_HandleType		p_key_one=&g_key_one;

///////////////////////////////////////////////////////////////////////////////
//////函		数:
//////功		能: 初始化按键1
//////输入参	数:
//////输出参	数:
//////说		明:
//////////////////////////////////////////////////////////////////////////////
uint8_t key_init_one(void)
{
	//--->>>配置端口中断---开始
	//---不使能中断
	PMK0 = 1U;    /* disable INTP7 operation */
	//---清楚中断标志
	PIF0 = 0U;    /* clear INTP7 interrupt flag */

	//---设置中断优先级
	PPR10 = 0U;
	PPR00 = 1U;

	//---设置下降沿触发
	EGN0 |= _01_INTP0_EDGE_FALLING_SEL;

	//---设置Key为输入模式且上拉使能
	gpio_task_pin_mode_input(KEY_BUTTON_PORT_ONE, KEY_BUTTON_BIT_ONE);
	gpio_task_pin_mode_pull_up_set(KEY_BUTTON_PORT_ONE, KEY_BUTTON_BIT_ONE);

	//---清楚中断标志
	PIF0 = 0U;
	//---使能中断
	PMK0 = 0U;

	return OK_0;
}

///////////////////////////////////////////////////////////////////////////////
//////函		数:
//////功		能: 启动按键1中断
//////输入参	数:
//////输出参	数:
//////说		明:
//////////////////////////////////////////////////////////////////////////////
uint8_t key_start_one(void)
{
	//---清除中断标识
	PIF0 = 0U;    
	//---使能中断
	PMK0 = 0U;    
	return OK_0;
}

///////////////////////////////////////////////////////////////////////////////
//////函		数:
//////功		能: 停止按键1中断
//////输入参	数:
//////输出参	数:
//////说		明:
//////////////////////////////////////////////////////////////////////////////
uint8_t key_stop_one(void)
{
	//---使能中断
	PMK0 = 1U;    
	//---清除中断标识
	PIF0 = 0U;   
	return OK_0;
}

///////////////////////////////////////////////////////////////////////////////
//////函		数:
//////功		能: 
//////输入参	数:
//////输出参	数:
//////说		明:
//////////////////////////////////////////////////////////////////////////////
uint8_t key_pin_level_one(void)
{
	return (uint8_t)((KEY_BUTTON_PORT_ONE!=NULL)?(PIN_GET_STATE(KEY_BUTTON_PORT_ONE,KEY_BUTTON_BIT_ONE)):0);
}

///////////////////////////////////////////////////////////////////////////////
//////函		数:
//////功		能: 
//////输入参	数:
//////输出参	数:
//////说		明:
//////////////////////////////////////////////////////////////////////////////
uint8_t key_it_irq_one(KEY_HandleType *KEYx)
{
	//---停止按键中断
	key_stop_one();
	//---标注有按键按下
#if (KEY_BUTTON_MAX_NUM>1)

#else
	
#endif
	return OK_0;
}

