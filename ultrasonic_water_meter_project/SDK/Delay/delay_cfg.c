#include "delay_cfg.h"

///////////////////////////////////////////////////////////////////////////////
//////函		数:
//////功		能: 
//////输入参	数:
//////输出参	数:
//////说		明:
//////////////////////////////////////////////////////////////////////////////
void delay_nop(uint32_t cnt)
{
	/*while ((cnt--))
	{
		__nop();
	}*/
	
	while (1)
	{
		//__nop();
		if (cnt==0)
		{
			break;
		}
		else
		{
			cnt--;
		}
	}
}

///////////////////////////////////////////////////////////////////////////////
//////函		数:
//////功		能: 延时等待时间
//////输入参	数:
//////输出参	数:
//////说		明:
//////////////////////////////////////////////////////////////////////////////
void delay_tick_ms(uint32_t ms)
{
	sys_tick_task_wait_ms(SYS_TICK_TASK_ONE, ms);
}

///////////////////////////////////////////////////////////////////////////////
//////函		数:
//////功		能: 延时等待时间
//////输入参	数:
//////输出参	数:
//////说		明:
//////////////////////////////////////////////////////////////////////////////
void delay_tick_s(uint32_t s)
{
	sys_tick_task_wait_s(SYS_TICK_TASK_ONE, s);
}


///////////////////////////////////////////////////////////////////////////////
//////函		数:
//////功		能: 
//////输入参	数:
//////输出参	数:
//////说		明:
//////////////////////////////////////////////////////////////////////////////
void delay_n_us(uint32_t us)
{
	if (SYS_CLOCK_MHZ>8)
	{
		us *= (SYS_CLOCK_MHZ / 8);
	}
	delay_clk_nop(us);
}

///////////////////////////////////////////////////////////////////////////////
//////函		数:
//////功		能: 
//////输入参	数:
//////输出参	数:
//////说		明:
//////////////////////////////////////////////////////////////////////////////
void delay_n_ms(uint32_t ms)
{
	while (ms>0)
	{
		delay_n_us(999);
		//---喂狗操作
		WDT_RESET();
	}
}

///////////////////////////////////////////////////////////////////////////////
//////函		数:
//////功		能: 
//////输入参	数:
//////输出参	数:
//////说		明:
//////////////////////////////////////////////////////////////////////////////
void delay_n_s(uint32_t s)
{
	while (s > 0)
	{
		//---延时等待
		delay_n_ms(1000);
	}
}

///////////////////////////////////////////////////////////////////////////////
//////函		数:
//////功		能: 
//////输入参	数:
//////输出参	数:
//////说		明:
//////////////////////////////////////////////////////////////////////////////
void delay_us(uint32_t us)
{
	delay_n_us(us);
}

///////////////////////////////////////////////////////////////////////////////
//////函		数:
//////功		能: 
//////输入参	数:
//////输出参	数:
//////说		明:
//////////////////////////////////////////////////////////////////////////////
void delay_ms(uint32_t ms)
{
	delay_tick_ms(ms);
}

///////////////////////////////////////////////////////////////////////////////
//////函		数:
//////功		能: 
//////输入参	数:
//////输出参	数:
//////说		明:
//////////////////////////////////////////////////////////////////////////////
void delay_s(uint32_t ms)
{
	delay_tick_s(ms);
}

///////////////////////////////////////////////////////////////////////////////
//////函		数:
//////功		能: 系统延时函数
//////输入参	数:
//////输出参	数:
//////说		明:
//////////////////////////////////////////////////////////////////////////////
#pragma inline_asm delay_clk_nop
void delay_clk_nop(uint32_t us)
{
	ADDW AX, #1;	//1
	MOVW DE, AX;	//1
	SKNC;			//1
	INCW BC;		//1
	MOVW AX, DE;	//1
	SUBW AX, #1;	//1
	BNZ	 $_delay_clk_nop+0x08;	//2/4
	//RET			//6
}

///////////////////////////////////////////////////////////////////////////////
//////函		数:
//////功		能: 延时1us 
//////输入参	数:
//////输出参	数:
//////说		明:
//////////////////////////////////////////////////////////////////////////////
void delay_1us(uint32_t us)
{
	if (SYS_CLOCK_MHZ > 8)
	{
		us *= (SYS_CLOCK_MHZ / 8);
	}
	delay_clk_nop(us);
}